<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>M√°y T√≠nh Th·ªëng K√™</title>
    <link rel="stylesheet" href="./assets/styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>üìä M√°y T√≠nh Th·ªëng K√™</h1>
            <p>Nh·∫≠p d√£y s·ªë nguy√™n ƒë·ªÉ ph√¢n t√≠ch th·ªëng k√™</p>
        </header>

        <div class="input-section">
            <label for="numberInput">Nh·∫≠p d√£y s·ªë (c√°ch nhau b·∫±ng d·∫•u ph·∫©y ho·∫∑c kho·∫£ng tr·∫Øng):</label>
            <input type="text" id="numberInput" placeholder="V√≠ d·ª•: 1, 2, 3, 4, 5 ho·∫∑c 1 2 3 4 5">
            <button onclick="calculateStats()">T√≠nh To√°n</button>
            <button onclick="clearAll()">X√≥a</button>
        </div>

        <div id="results" class="results hidden">
            <div class="stat-card">
                <h3>üìà D√£y S·ªë ƒê√£ S·∫Øp X·∫øp</h3>
                <div id="sortedArray" class="result-value"></div>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <h4>üìä Trung B√¨nh</h4>
                    <div id="mean" class="result-value"></div>
                </div>

                <div class="stat-card">
                    <h4>üìç Trung V·ªã</h4>
                    <div id="median" class="result-value"></div>
                </div>

                <div class="stat-card">
                    <h4>üéØ Mode</h4>
                    <div id="mode" class="result-value"></div>
                </div>

                <div class="stat-card">
                    <h4>‚¨ÜÔ∏è GTLN (Max)</h4>
                    <div id="max" class="result-value"></div>
                </div>

                <div class="stat-card">
                    <h4>‚¨áÔ∏è GTNN (Min)</h4>
                    <div id="min" class="result-value"></div>
                </div>

                <div class="stat-card">
                    <h4>‚ÜîÔ∏è Kho·∫£ng (Range)</h4>
                    <div id="range" class="result-value"></div>
                </div>

                <div class="stat-card">
                    <h4>üìè Ph∆∞∆°ng Sai</h4>
                    <div id="variance" class="result-value"></div>
                </div>

                <div class="stat-card">
                    <h4>üìê ƒê·ªô L·ªách Chu·∫©n</h4>
                    <div id="stdDev" class="result-value"></div>
                </div>

                <div class="stat-card">
                    <h4>üìä H·ªá S·ªë Bi·∫øn Thi√™n</h4>
                    <div id="coeffVar" class="result-value"></div>
                </div>
            </div>
        </div>

        <div id="error" class="error hidden"></div>
    </div>

    <script>
        function parseInput(input) {
            return input.split(/[,\s]+/)
                       .map(num => num.trim())
                       .filter(num => num !== '')
                       .map(num => parseInt(num))
                       .filter(num => !isNaN(num));
        }

        function calculateMean(arr) {
            return arr.reduce((sum, num) => sum + num, 0) / arr.length;
        }

        function calculateMedian(sortedArr) {
            const mid = Math.floor(sortedArr.length / 2);
            return sortedArr.length % 2 === 0 
                ? (sortedArr[mid - 1] + sortedArr[mid]) / 2 
                : sortedArr[mid];
        }

        function calculateMode(arr) {
            const frequency = {};
            arr.forEach(num => frequency[num] = (frequency[num] || 0) + 1);
            
            const maxFreq = Math.max(...Object.values(frequency));
            const modes = Object.keys(frequency).filter(key => frequency[key] === maxFreq);
            
            if (modes.length === arr.length) {
                return "Kh√¥ng c√≥ mode";
            }
            
            return modes.map(Number).sort((a, b) => a - b).join(', ');
        }

        function calculateVariance(arr, mean) {
            const sumSquaredDiffs = arr.reduce((sum, num) => sum + Math.pow(num - mean, 2), 0);
            return sumSquaredDiffs / arr.length;
        }

        function calculateStats() {
            const input = document.getElementById('numberInput').value;
            const errorDiv = document.getElementById('error');
            const resultsDiv = document.getElementById('results');

            // Clear previous error
            errorDiv.classList.add('hidden');

            if (!input.trim()) {
                showError('Vui l√≤ng nh·∫≠p d√£y s·ªë!');
                return;
            }

            const numbers = parseInput(input);

            if (numbers.length === 0) {
                showError('Kh√¥ng t√¨m th·∫•y s·ªë nguy√™n h·ª£p l·ªá!');
                return;
            }

            // Sort array
            const sortedNumbers = [...numbers].sort((a, b) => a - b);

            // Calculate statistics
            const mean = calculateMean(numbers);
            const median = calculateMedian(sortedNumbers);
            const mode = calculateMode(numbers);
            const max = Math.max(...numbers);
            const min = Math.min(...numbers);
            const range = max - min;
            const variance = calculateVariance(numbers, mean);
            const stdDev = Math.sqrt(variance);
            const coeffVar = mean !== 0 ? (stdDev / Math.abs(mean)) * 100 : 0;

            // Display results
            document.getElementById('sortedArray').textContent = sortedNumbers.join(', ');
            document.getElementById('mean').textContent = mean.toFixed(2);
            document.getElementById('median').textContent = median.toFixed(2);
            document.getElementById('mode').textContent = mode;
            document.getElementById('max').textContent = max;
            document.getElementById('min').textContent = min;
            document.getElementById('range').textContent = range;
            document.getElementById('variance').textContent = variance.toFixed(2);
            document.getElementById('stdDev').textContent = stdDev.toFixed(2);
            document.getElementById('coeffVar').textContent = coeffVar.toFixed(2) + '%';

            resultsDiv.classList.remove('hidden');
        }

        function showError(message) {
            const errorDiv = document.getElementById('error');
            errorDiv.textContent = message;
            errorDiv.classList.remove('hidden');
            document.getElementById('results').classList.add('hidden');
        }

        function clearAll() {
            document.getElementById('numberInput').value = '';
            document.getElementById('results').classList.add('hidden');
            document.getElementById('error').classList.add('hidden');
        }

        // Allow Enter key to trigger calculation
        document.getElementById('numberInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                calculateStats();
            }
        });
    </script>
</body>
</html>
